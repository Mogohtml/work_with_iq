import os
import vk_api
import time
import random
import logging
import pandas as pd
import requests

# Настройка логирования
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s',
    handlers=[
        logging.StreamHandler()
    ]
)
logger = logging.getLogger(__name__)

class VKGroupParser:
    def __init__(self, token: str):
        self.token = token
        self.session = vk_api.VkApi(token=token)
        self.vk = self.session.get_api()
        self.user_id = None
        self.requests_count = 0
        self.last_request_time = 0
        self.skip_group = False
        self.keywords = [
            ["нужен", "дизайнер", "логотипа"],
            ["заказать", "логотип", "срочно"],
            ["создать", "логотип", "бизнеса"],
            ["дизайн", "логотипа", "недорого"],
            ["фрилансер", "логотип", "вектор"],
            ["логотип", "с", "текстом"],
            ["логотип", "минималистичный", "стартап"],
            ["логотип", "бренда", "компания"],
            ["дизайн", "баннера", "рекламы"],
            ["баннер", "соцсетей", "яркий"],
            ["заказать", "баннер", "акции"],
            ["баннер", "текстом", "адаптивный"],
            ["фрилансер", "баннер", "psd"],
            ["баннер", "рекламы", "креативный"],
            ["дизайн", "брендинга", "компании"],
            ["разработка", "бренда", "стартапа"],
            ["брендинг", "фирменный", "стиль"],
            ["логотип", "брендбук", "комплексный"],
            ["брендинг", "стартапа", "недорого"],
            ["фрилансер", "брендинг", "полный"],
            ["ui", "ux", "дизайн"],
            ["интерфейс", "приложения", "мобильного"],
            ["дизайн", "сайта", "ui"],
            ["ux", "лендинга", "прототип"],
            ["фрилансер", "ui", "ux"],
            ["дизайн", "веб", "интерфейса"],
            ["ui", "исследование", "ux"],
            ["дизайн", "графики", "логотип"],
            ["графический", "дизайн", "иллюстрации"],
            ["дизайн", "постеров", "рекламы"],
            ["фрилансер", "графика", "креатив"],
            ["графика", "баннера", "яркая"],
            ["дизайн", "упаковки", "продукта"],
            ["упаковка", "этикетки", "креативная"],
            ["фрилансер", "упаковка", "дизайн"],
            ["упаковка", "бренда", "минимализм"],
            ["дизайн", "интерьера", "комнаты"],
            ["визуализация", "интерьера", "3d"],
            ["фрилансер", "интерьер", "минимализм"],
            ["интерьер", "дизайн", "современный"],
            ["заказать", "дизайн", "услуги"],
            ["найти", "дизайнера", "фрилансе"],
            ["дизайнер", "проекты", "портфолио"],
            ["дизайн", "идеи", "концепции"],
            ["дизайн", "презентации", "бизнеса"],
            ["дизайн", "маркетинга", "визуал"],
            ["дизайн", "стартапа", "логотип"],
            ["дизайн", "рекламы", "баннер"],
            ["дизайн", "упаковки", "креатив"],
            ["дизайн", "интерьера", "визуал"],
            ["дизайн", "веб", "интерфейс"],
            ["дизайн", "мобильного", "приложения"],
            ["дизайн", "бренда", "стиль"],
            ["дизайн", "баннера", "соцсети"],
            ["дизайн", "брендинга", "компания"],
            ["дизайн", "ui", "ux"],
            ["дизайн", "графики", "иллюстрация"],
            ["дизайн", "постера", "реклама"],
            ["дизайн", "этикетки", "упаковка"],
            ["дизайн", "интерьера", "3d"],
            ["дизайн", "презентации", "стартап"],
            ["дизайн", "маркетинга", "креатив"],
            ["дизайн", "стартапа", "бренд"],
            ["дизайн", "рекламы", "визуал"],
            ["дизайн", "упаковки", "бренд"],
            ["дизайн", "интерьера", "современный"],
            ["дизайн", "веб", "дизайн"],
            ["дизайн", "мобильного", "ui"],
            ["дизайн", "бренда", "логотип"],
            ["дизайн", "баннера", "реклама"],
            ["дизайн", "брендинга", "фирменный"],
            ["дизайн", "ui", "интерфейс"],
            ["дизайн", "графики", "баннер"],
            ["дизайн", "постера", "креатив"],
            ["дизайн", "этикетки", "дизайн"],
            ["дизайн", "интерьера", "визуализация"],
            ["дизайн", "презентации", "дизайн"],
            ["дизайн", "маркетинга", "баннер"],
            ["дизайн", "стартапа", "дизайн"],
            ["дизайн", "рекламы", "логотип"],
            ["дизайн", "упаковки", "логотип"],
            ["дизайн", "интерьера", "дизайн"],
            ["дизайн", "веб", "логотип"],
            ["дизайн", "мобильного", "логотип"],
            ["дизайн", "бренда", "баннер"],
            ["дизайн", "баннера", "брендинг"],
            ["дизайн", "брендинга", "ui"],
            ["дизайн", "ui", "графика"],
            ["дизайн", "графики", "постер"],
            ["дизайн", "постера", "этикетка"],
            ["дизайн", "этикетки", "интерьер"],
            ["дизайн", "интерьера", "презентация"],
            ["дизайн", "презентации", "маркетинг"],
            ["дизайн", "маркетинга", "стартап"],
            ["дизайн", "стартапа", "реклама"],
            ["дизайн", "рекламы", "упаковка"],
            ["дизайн", "упаковки", "интерьер"],
            ["дизайн", "интерьера", "веб"],
            ["дизайн", "веб", "мобильный"],
            ["дизайн", "мобильный", "бренд"],
            ["дизайн", "бренд", "баннер"],
            ["дизайн", "баннер", "брендинг"],
            ["дизайн", "брендинг", "ui"],
            ["дизайн", "ui", "графика"],
            ["дизайн", "графика", "постер"],
            ["дизайн", "постер", "этикетка"],
            ["дизайн", "этикетка", "интерьер"],
            ["дизайн", "интерьер", "презентация"],
            ["дизайн", "презентация", "маркетинг"],
            ["дизайн", "маркетинг", "стартап"],
            ["дизайн", "стартап", "реклама"],
            ["дизайн", "реклама", "упаковка"],
            ["дизайн", "упаковка", "интерьер"],
            ["дизайн", "интерьер", "веб"],
            ["дизайн", "веб", "мобильный"],
            ["дизайн", "мобильный", "бренд"],
            ["дизайн", "бренд", "баннер"],
            ["дизайн", "баннер", "брендинг"],
            ["дизайн", "брендинг", "ui"],
            ["дизайн", "ui", "графика"],
            ["дизайн", "графика", "постер"],
            ["дизайн", "постер", "этикетка"],
            ["дизайн", "этикетка", "интерьер"],
            ["дизайн", "интерьер", "презентация"],
            ["дизайн", "презентация", "маркетинг"],
            ["дизайн", "маркетинг", "стартап"],
            ["дизайн", "стартап", "реклама"],
            ["дизайн", "реклама", "упаковка"],
            ["дизайн", "упаковка", "интерьер"],
            ["дизайн", "интерьер", "веб"],
            ["дизайн", "веб", "мобильный"],
            ["дизайн", "мобильный", "бренд"],
            ["дизайн", "бренд", "баннер"],
            ["дизайн", "баннер", "брендинг"],
            ["дизайн", "брендинг", "ui"],
            ["дизайн", "ui", "графика"],
            ["дизайн", "графика", "постер"],
            ["дизайн", "постер", "этикетка"],
            ["дизайн", "этикетка", "интерьер"],
            ["дизайн", "интерьер", "презентация"],
            ["дизайн", "презентация", "маркетинг"],
            ["дизайн", "маркетинг", "стартап"],
            ["дизайн", "стартап", "реклама"],
            ["дизайн", "реклама", "упаковка"],
            ["дизайн", "упаковка", "интерьер"],
            ["дизайн", "интерьер", "веб"],
            ["дизайн", "веб", "мобильный"],
            ["дизайн", "мобильный", "бренд"],
            ["дизайн", "бренд", "баннер"],
            ["дизайн", "баннер", "брендинг"],
            ["дизайн", "брендинг", "ui"],
            ["дизайн", "ui", "графика"],
            ["дизайн", "графика", "постер"],
            ["дизайн", "постер", "этикетка"],
            ["дизайн", "этикетка", "интерьер"],
            ["дизайн", "интерьер", "презентация"],
            ["дизайн", "презентация", "маркетинг"],
            ["дизайн", "маркетинг", "стартап"],
            ["дизайн", "стартап", "реклама"],
            ["дизайн", "реклама", "упаковка"],
            ["дизайн", "упаковка", "интерьер"],
            ["дизайн", "интерьер", "веб"],
            ["дизайн", "веб", "мобильный"],
            ["дизайн", "мобильный", "бренд"],
            ["дизайн", "бренд", "баннер"],
            ["дизайн", "баннер", "брендинг"],
            ["дизайн", "брендинг", "ui"],
            ["дизайн", "ui", "графика"],
            ["дизайн", "графика", "постер"],
            ["дизайн", "постер", "этикетка"],
            ["дизайн", "этикетка", "интерьер"],
            ["дизайн", "интерьер", "презентация"],
            ["дизайн", "презентация", "маркетинг"],
            ["дизайн", "маркетинг", "стартап"],
            ["дизайн", "стартап", "реклама"],
            ["дизайн", "реклама", "упаковка"],
            ["дизайн", "упаковка", "интерьер"],
            ["дизайн", "интерьер", "веб"],
            ["дизайн", "веб", "мобильный"],
            ["дизайн", "мобильный", "бренд"],
            ["дизайн", "бренд", "баннер"],
            ["дизайн", "баннер", "брендинг"],
            ["дизайн", "брендинг", "ui"],
            ["дизайн", "ui", "графика"],
            ["дизайн", "графика", "постер"],
            ["дизайн", "постер", "этикетка"],
            ["дизайн", "этикетка", "интерьер"],
            ["дизайн", "интерьер", "презентация"],
            ["дизайн", "презентация", "маркетинг"],
            ["дизайн", "маркетинг", "стартап"],
            ["дизайн", "стартап", "реклама"],
            ["дизайн", "реклама", "упаковка"],
            ["дизайн", "упаковка", "интерьер"],
            ["дизайн", "интерьер", "веб"],
            ["дизайн", "веб", "мобильный"],
            ["дизайн", "мобильный", "бренд"],
            ["дизайн", "бренд", "баннер"],
            ["дизайн", "баннер", "брендинг"],
            ["дизайн", "брендинг", "ui"],
            ["дизайн", "ui", "графика"],
            ["дизайн", "графика", "постер"],
            ["дизайн", "постер", "этикетка"],
            ["дизайн", "этикетка", "интерьер"],
            ["дизайн", "интерьер", "презентация"],
            ["дизайн", "презентация", "маркетинг"],
            ["дизайн", "маркетинг", "стартап"],
            ["дизайн", "стартап", "реклама"],
            ["дизайн", "реклама", "упаковка"],
            ["дизайн", "упаковка", "интерьер"],
            ["дизайн", "интерьер", "веб"],
            ["дизайн", "веб", "мобильный"],
            ["дизайн", "мобильный", "бренд"],
            ["дизайн", "бренд", "баннер"],
            ["дизайн", "баннер", "брендинг"],
            ["дизайн", "брендинг", "ui"],
            ["дизайн", "ui", "графика"],
            ["дизайн", "графика", "постер"],
            ["дизайн", "постер", "этикетка"],
            ["дизайн", "этикетка", "интерьер"],
            ["дизайн", "интерьер", "презентация"],
            ["дизайн", "презентация", "маркетинг"],
            ["дизайн", "маркетинг", "стартап"],
            ["дизайн", "стартап", "реклама"],
            ["дизайн", "реклама", "упаковка"],
            ["дизайн", "упаковка", "интерьер"],
            ["дизайн", "интерьер", "веб"],
            ["дизайн", "веб", "мобильный"],
            ["дизайн", "мобильный", "бренд"],
            ["дизайн", "бренд", "баннер"],
            ["дизайн", "баннер", "брендинг"],
            ["дизайн", "брендинг", "ui"],
            ["дизайн", "ui", "графика"],
            ["дизайн", "графика", "постер"],
            ["дизайн", "постер", "этикетка"],
            ["дизайн", "этикетка", "интерьер"],
            ["дизайн", "интерьер", "презентация"],
            ["дизайн", "презентация", "маркетинг"],
            ["дизайн", "маркетинг", "стартап"],
            ["дизайн", "стартап", "реклама"],
            ["дизайн", "реклама", "упаковка"],
            ["дизайн", "упаковка", "интерьер"],
            ["дизайн", "интерьер", "веб"],
            ["дизайн", "веб", "мобильный"],
            ["дизайн", "мобильный", "бренд"],
            ["дизайн", "бренд", "баннер"],
            ["дизайн", "баннер", "брендинг"],
            ["дизайн", "брендинг", "ui"],
            ["дизайн", "ui", "графика"],
            ["дизайн", "графика", "постер"],
            ["дизайн", "постер", "этикетка"],
            ["дизайн", "этикетка", "интерьер"],
            ["дизайн", "интерьер", "презентация"],
            ["дизайн", "аватарки", "соцсети"],
            ["аватарки", "профиль", "креатив"],
            ["заказать", "аватарку", "дизайн"],
            ["аватарка", "бренда", "яркая"],
            ["фрилансер", "аватарки", "стиль"],
            ["дизайн", "стикеры", "telegram"],
            ["стикеры", "анимация", "бренд"],
            ["заказать", "стикеры", "дизайн"],
            ["стикеры", "vk", "креатив"],
            ["фрилансер", "стикеры", "иллюстрация"],
            ["дизайн", "qr", "коды"],
            ["qr", "код", "бренд"],
            ["заказать", "qr", "дизайн"],
            ["qr", "код", "адаптивный"],
            ["фрилансер", "qr", "коды"],
            ["дизайн", "сайта", "лендинг"],
            ["сайт", "дизайн", "ui"],
            ["заказать", "сайт", "дизайн"],
            ["сайт", "веб", "интерфейс"],
            ["фрилансер", "сайт", "дизайн"],
            ["дизайн", "бота", "telegram"],
            ["бот", "дизайн", "интерфейс"],
            ["заказать", "бот", "дизайн"],
            ["бот", "ui", "ux"],
            ["фрилансер", "бот", "дизайн"],
            ["дизайн", "приложения", "мобильного"],
            ["приложение", "дизайн", "ui"],
            ["заказать", "приложение", "дизайн"],
            ["приложение", "ux", "интерфейс"],
            ["фрилансер", "приложение", "дизайн"],
            ["дизайн", "визитки", "бренд"],
            ["визитки", "дизайн", "креатив"],
            ["заказать", "визитки", "дизайн"],
            ["визитки", "фирменный", "стиль"],
            ["фрилансер", "визитки", "дизайн"],
            ["дизайн", "плакаты", "реклама"],
            ["плакаты", "дизайн", "яркий"],
            ["заказать", "плакаты", "дизайн"],
            ["плакаты", "креатив", "баннер"],
            ["фрилансер", "плакаты", "дизайн"],
            ["дизайн", "буклеты", "компания"],
            ["буклеты", "дизайн", "информативный"],
            ["заказать", "буклеты", "дизайн"],
            ["буклеты", "фирменный", "стиль"],
            ["фрилансер", "буклеты", "дизайн"],
            ["дизайн", "меню", "ресторан"],
            ["меню", "дизайн", "креатив"],
            ["заказать", "меню", "дизайн"],
            ["меню", "бренд", "стиль"],
            ["фрилансер", "меню", "дизайн"],
            ["дизайн", "каталоги", "продукты"],
            ["каталоги", "дизайн", "визуал"],
            ["заказать", "каталоги", "дизайн"],
            ["каталоги", "фирменный", "стиль"],
            ["фрилансер", "каталоги", "дизайн"],
            ["дизайн", "презентации", "бизнес"],
            ["презентации", "дизайн", "эффектный"],
            ["заказать", "презентации", "дизайн"],
            ["презентации", "визуал", "креатив"],
            ["фрилансер", "презентации", "дизайн"],
            ["дизайн", "инфографики", "данные"],
            ["инфографика", "дизайн", "понятный"],
            ["заказать", "инфографику", "дизайн"],
            ["инфографика", "визуал", "данных"],
            ["фрилансер", "инфографика", "дизайн"],
            ["дизайн", "анимации", "видео"],
            ["анимация", "дизайн", "динамичный"],
            ["заказать", "анимацию", "дизайн"],
            ["анимация", "видео", "креатив"],
            ["фрилансер", "анимация", "дизайн"],
            ["дизайн", "иконки", "приложение"],
            ["иконки", "дизайн", "минималистичный"],
            ["заказать", "иконки", "дизайн"],
            ["иконки", "ui", "ux"],
            ["фрилансер", "иконки", "дизайн"],
            ["дизайн", "шрифты", "бренд"],
            ["шрифты", "дизайн", "уникальный"],
            ["заказать", "шрифты", "дизайн"],
            ["шрифты", "фирменный", "стиль"],
            ["фрилансер", "шрифты", "дизайн"],
            ["дизайн", "цвета", "палитра"],
            ["цвета", "дизайн", "гармоничный"],
            ["заказать", "палитру", "дизайн"],
            ["палитра", "бренд", "цвета"],
            ["фрилансер", "палитра", "дизайн"],
            ["дизайн", "логотипы", "варианты"],
            ["логотипы", "дизайн", "несколько"],
            ["заказать", "логотипы", "дизайн"],
            ["логотипы", "бренд", "варианты"],
            ["фрилансер", "логотипы", "дизайн"],
            ["дизайн", "баннеры", "реклама"],
            ["баннеры", "дизайн", "яркий"],
            ["заказать", "баннеры", "дизайн"],
            ["баннеры", "соцсети", "креатив"],
            ["фрилансер", "баннеры", "дизайн"],
            ["дизайн", "аватарки", "профиль"],
            ["аватарки", "дизайн", "стильный"],
            ["заказать", "аватарки", "дизайн"],
            ["аватарки", "бренд", "яркий"],
            ["фрилансер", "аватарки", "дизайн"],
            ["дизайн", "стикеры", "анимация"],
            ["стикеры", "дизайн", "telegram"],
            ["заказать", "стикеры", "дизайн"],
            ["стикеры", "vk", "креатив"],
            ["фрилансер", "стикеры", "дизайн"],
            ["дизайн", "qr", "код"],
            ["qr", "дизайн", "адаптивный"],
            ["заказать", "qr", "дизайн"],
            ["qr", "код", "бренд"],
            ["фрилансер", "qr", "дизайн"],
            ["дизайн", "сайта", "лендинг"],
            ["сайт", "дизайн", "ui"],
            ["заказать", "сайт", "дизайн"],
            ["сайт", "веб", "интерфейс"],
            ["фрилансер", "сайт", "дизайн"],
            ["дизайн", "бота", "интерфейс"],
            ["бот", "дизайн", "telegram"],
            ["заказать", "бот", "дизайн"],
            ["бот", "ui", "ux"],
            ["фрилансер", "бот", "дизайн"],
            ["дизайн", "приложения", "интерфейс"],
            ["приложение", "дизайн", "мобильное"],
            ["заказать", "приложение", "дизайн"],
            ["приложение", "ux", "дизайн"],
            ["фрилансер", "приложение", "дизайн"],
            ["дизайн", "визитки", "креатив"],
            ["визитки", "дизайн", "бренд"],
            ["заказать", "визитки", "дизайн"],
            ["визитки", "фирменный", "стиль"],
            ["фрилансер", "визитки", "дизайн"],
            ["дизайн", "плакаты", "яркий"],
            ["плакаты", "дизайн", "реклама"],
            ["заказать", "плакаты", "дизайн"],
            ["плакаты", "креатив", "баннер"],
            ["фрилансер", "плакаты", "дизайн"],
            ["дизайн", "буклеты", "информативный"],
            ["буклеты", "дизайн", "компания"],
            ["заказать", "буклеты", "дизайн"],
            ["буклеты", "фирменный", "стиль"],
            ["фрилансер", "буклеты", "дизайн"],
            ["дизайн", "меню", "креатив"],
            ["меню", "дизайн", "ресторан"],
            ["заказать", "меню", "дизайн"],
            ["меню", "бренд", "стиль"],
            ["фрилансер", "меню", "дизайн"],
            ["дизайн", "каталоги", "визуал"],
            ["каталоги", "дизайн", "продукты"],
            ["заказать", "каталоги", "дизайн"],
            ["каталоги", "фирменный", "стиль"],
            ["фрилансер", "каталоги", "дизайн"],
            ["дизайн", "презентации", "эффектный"],
            ["презентации", "дизайн", "бизнес"],
            ["заказать", "презентации", "дизайн"],
            ["презентации", "визуал", "креатив"],
            ["фрилансер", "презентации", "дизайн"],
            ["дизайн", "инфографики", "понятный"],
            ["инфографика", "дизайн", "данные"],
            ["заказать", "инфографику", "дизайн"],
            ["инфографика", "визуал", "данных"],
            ["фрилансер", "инфографика", "дизайн"],
            ["дизайн", "анимации", "динамичный"],
            ["анимация", "дизайн", "видео"],
            ["заказать", "анимацию", "дизайн"],
            ["анимация", "видео", "креатив"],
            ["фрилансер", "анимация", "дизайн"],
            ["дизайн", "иконки", "минималистичный"],
            ["иконки", "дизайн", "приложение"],
            ["заказать", "иконки", "дизайн"],
            ["иконки", "ui", "ux"],
            ["фрилансер", "иконки", "дизайн"],
            ["дизайн", "шрифты", "уникальный"],
            ["шрифты", "дизайн", "бренд"],
            ["заказать", "шрифты", "дизайн"],
            ["шрифты", "фирменный", "стиль"],
            ["фрилансер", "шрифты", "дизайн"],
            ["дизайн", "цвета", "гармоничный"],
            ["цвета", "дизайн", "палитра"],
            ["заказать", "палитру", "дизайн"],
            ["палитра", "бренд", "цвета"],
            ["фрилансер", "палитра", "дизайн"],
            ["дизайн", "логотипы", "несколько"],
            ["логотипы", "дизайн", "варианты"],
            ["заказать", "логотипы", "дизайн"],
            ["логотипы", "бренд", "варианты"],
            ["фрилансер", "логотипы", "дизайн"],
            ["дизайн", "баннеры", "яркий"],
            ["баннеры", "дизайн", "реклама"],
            ["заказать", "баннеры", "дизайн"],
            ["баннеры", "соцсети", "креатив"],
            ["фрилансер", "баннеры", "дизайн"],
            ["дизайн", "аватарки", "стильный"],
            ["аватарки", "дизайн", "профиль"],
            ["заказать", "аватарки", "дизайн"],
            ["аватарки", "бренд", "яркий"],
            ["фрилансер", "аватарки", "дизайн"],
            ["дизайн", "стикеры", "telegram"],
            ["стикеры", "дизайн", "анимация"],
            ["заказать", "стикеры", "дизайн"],
            ["стикеры", "vk", "креатив"],
            ["фрилансер", "стикеры", "дизайн"],
            ["дизайн", "qr", "адаптивный"],
            ["qr", "дизайн", "код"],
            ["заказать", "qr", "дизайн"],
            ["qr", "код", "бренд"],
            ["фрилансер", "qr", "дизайн"],
            ["дизайн", "сайта", "ui"],
            ["сайт", "дизайн", "лендинг"],
            ["заказать", "сайт", "дизайн"],
            ["сайт", "веб", "интерфейс"],
            ["фрилансер", "сайт", "дизайн"],
            ["дизайн", "бота", "telegram"],
            ["бот", "дизайн", "интерфейс"],
            ["заказать", "бот", "дизайн"],
            ["бот", "ui", "ux"],
            ["фрилансер", "бот", "дизайн"],
            ["дизайн", "приложения", "мобильное"],
            ["приложение", "дизайн", "интерфейс"],
            ["заказать", "приложение", "дизайн"],
            ["приложение", "ux", "дизайн"],
            ["фрилансер", "приложение", "дизайн"],
            ["дизайн", "визитки", "бренд"],
            ["визитки", "дизайн", "креатив"],
            ["заказать", "визитки", "дизайн"],
            ["визитки", "фирменный", "стиль"],
            ["фрилансер", "визитки", "дизайн"],
            ["дизайн", "плакаты", "реклама"],
            ["плакаты", "дизайн", "яркий"],
            ["заказать", "плакаты", "дизайн"],
            ["плакаты", "креатив", "баннер"],
            ["фрилансер", "плакаты", "дизайн"],
            ["дизайн", "буклеты", "компания"],
            ["буклеты", "дизайн", "информативный"],
            ["заказать", "буклеты", "дизайн"],
            ["буклеты", "фирменный", "стиль"],
            ["фрилансер", "буклеты", "дизайн"],
            ["дизайн", "меню", "ресторан"],
            ["меню", "дизайн", "креатив"],
            ["заказать", "меню", "дизайн"],
            ["меню", "бренд", "стиль"],
            ["фрилансер", "меню", "дизайн"],
            ["дизайн", "каталоги", "продукты"],
            ["каталоги", "дизайн", "визуал"],
            ["заказать", "каталоги", "дизайн"],
            ["каталоги", "фирменный", "стиль"],
            ["фрилансер", "каталоги", "дизайн"],
            ["дизайн", "презентации", "бизнес"],
            ["презентации", "дизайн", "эффектный"],
            ["заказать", "презентации", "дизайн"],
            ["презентации", "визуал", "креатив"],
            ["фрилансер", "презентации", "дизайн"],
            ["дизайн", "инфографики", "данные"],
            ["инфографика", "дизайн", "понятный"],
            ["заказать", "инфографику", "дизайн"],
            ["инфографика", "визуал", "данных"],
            ["фрилансер", "инфографика", "дизайн"],
            ["дизайн", "анимации", "видео"],
            ["анимация", "дизайн", "динамичный"],
            ["заказать", "анимацию", "дизайн"],
            ["анимация", "видео", "креатив"],
            ["фрилансер", "анимация", "дизайн"],
            ["дизайн", "иконки", "приложение"],
            ["иконки", "дизайн", "минималистичный"],
            ["заказать", "иконки", "дизайн"],
            ["иконки", "ui", "ux"],
            ["фрилансер", "иконки", "дизайн"],
            ["дизайн", "шрифты", "бренд"],
            ["шрифты", "дизайн", "уникальный"],
            ["заказать", "шрифты", "дизайн"],
            ["шрифты", "фирменный", "стиль"],
            ["фрилансер", "шрифты", "дизайн"],
            ["дизайн", "цвета", "палитра"],
            ["цвета", "дизайн", "гармоничный"],
            ["заказать", "палитру", "дизайн"],
            ["палитра", "бренд", "цвета"],
            ["фрилансер", "палитра", "дизайн"],
            ["дизайн", "логотипы", "варианты"],
            ["логотипы", "дизайн", "несколько"],
            ["заказать", "логотипы", "дизайн"],
            ["логотипы", "бренд", "варианты"],
            ["фрилансер", "логотипы", "дизайн"],
            ["дизайн", "баннеры", "реклама"],
            ["баннеры", "дизайн", "яркий"],
            ["заказать", "баннеры", "дизайн"],
            ["баннеры", "соцсети", "креатив"],
            ["фрилансер", "баннеры", "дизайн"],
            ["дизайн", "аватарки", "профиль"],
            ["аватарки", "дизайн", "стильный"],
            ["заказать", "аватарки", "дизайн"],
            ["аватарки", "бренд", "яркий"],
            ["фрилансер", "аватарки", "дизайн"],
            ["дизайн", "стикеры", "анимация"],
            ["стикеры", "дизайн", "telegram"],
            ["заказать", "стикеры", "дизайн"],
            ["стикеры", "vk", "креатив"],
            ["фрилансер", "стикеры", "дизайн"],
            ["дизайн", "qr", "код"],
            ["qr", "дизайн", "адаптивный"],
            ["заказать", "qr", "дизайн"],
            ["qr", "код", "бренд"],
            ["фрилансер", "qr", "дизайн"],
            ["дизайн", "сайта", "лендинг"],
            ["сайт", "дизайн", "ui"],
            ["заказать", "сайт", "дизайн"],
            ["сайт", "веб", "интерфейс"],
            ["фрилансер", "сайт", "дизайн"],
            ["дизайн", "бота", "интерфейс"],
            ["бот", "дизайн", "telegram"],
            ["заказать", "бот", "дизайн"],
            ["бот", "ui", "ux"],
            ["фрилансер", "бот", "дизайн"],
            ["дизайн", "приложения", "интерфейс"],
            ["приложение", "дизайн", "мобильное"],
            ["заказать", "приложение", "дизайн"],
            ["приложение", "ux", "дизайн"],
            ["фрилансер", "приложение", "дизайн"],
            ["дизайн", "визитки", "креатив"],
            ["визитки", "дизайн", "бренд"],
            ["заказать", "визитки", "дизайн"],
            ["визитки", "фирменный", "стиль"],
            ["фрилансер", "визитки", "дизайн"],
            ["дизайн", "плакаты", "яркий"],
            ["плакаты", "дизайн", "реклама"],
            ["заказать", "плакаты", "дизайн"],
            ["плакаты", "креатив", "баннер"],
            ["фрилансер", "плакаты", "дизайн"],
            ["дизайн", "буклеты", "информативный"],
            ["буклеты", "дизайн", "компания"],
            ["заказать", "буклеты", "дизайн"],
            ["буклеты", "фирменный", "стиль"],
            ["фрилансер", "буклеты", "дизайн"],
            ["дизайн", "меню", "креатив"],
            ["меню", "дизайн", "ресторан"],
            ["заказать", "меню", "дизайн"],
            ["меню", "бренд", "стиль"],
            ["фрилансер", "меню", "дизайн"],
            ["дизайн", "каталоги", "визуал"],
            ["каталоги", "дизайн", "продукты"],
            ["заказать", "каталоги", "дизайн"],
            ["каталоги", "фирменный", "стиль"],
            ["фрилансер", "каталоги", "дизайн"],
            ["дизайн", "презентации", "эффектный"],
            ["презентации", "дизайн", "бизнес"],
            ["заказать", "презентации", "дизайн"],
            ["презентации", "визуал", "креатив"],
            ["фрилансер", "презентации", "дизайн"],
            ["дизайн", "инфографики", "понятный"],
            ["инфографика", "дизайн", "данные"],
            ["заказать", "инфографику", "дизайн"],
            ["инфографика", "визуал", "данных"],
            ["фрилансер", "инфографика", "дизайн"],
            ["дизайн", "анимации", "динамичный"],
            ["анимация", "дизайн", "видео"],
            ["заказать", "анимацию", "дизайн"],
            ["анимация", "видео", "креатив"],
            ["фрилансер", "анимация", "дизайн"],
            ["дизайн", "иконки", "минималистичный"],
            ["иконки", "дизайн", "приложение"],
            ["заказать", "иконки", "дизайн"],
            ["иконки", "ui", "ux"],
            ["фрилансер", "иконки", "дизайн"],
            ["дизайн", "шрифты", "уникальный"],
            ["шрифты", "дизайн", "бренд"],
            ["заказать", "шрифты", "дизайн"],
            ["шрифты", "фирменный", "стиль"],
            ["фрилансер", "шрифты", "дизайн"],
            ["дизайн", "цвета", "гармоничный"],
            ["цвета", "дизайн", "палитра"],
            ["заказать", "палитру", "дизайн"],
            ["палитра", "бренд", "цвета"],
            ["фрилансер", "палитра", "дизайн"],
            ["дизайн", "логотипы", "несколько"],
            ["логотипы", "дизайн", "варианты"],
            ["заказать", "логотипы", "дизайн"],
            ["логотипы", "бренд", "варианты"],
            ["фрилансер", "логотипы", "дизайн"],
            ["дизайн", "баннеры", "яркий"],
            ["баннеры", "дизайн", "реклама"],
            ["заказать", "баннеры", "дизайн"],
            ["баннеры", "соцсети", "креатив"],
            ["фрилансер", "баннеры", "дизайн"],
            ["дизайн", "аватарки", "стильный"],
            ["аватарки", "дизайн", "профиль"],
            ["заказать", "аватарки", "дизайн"],
            ["аватарки", "бренд", "яркий"],
            ["фрилансер", "аватарки", "дизайн"],
            ["дизайн", "стикеры", "telegram"],
            ["стикеры", "дизайн", "анимация"],
            ["заказать", "стикеры", "дизайн"],
            ["стикеры", "vk", "креатив"],
            ["фрилансер", "стикеры", "дизайн"],
            ["дизайн", "qr", "адаптивный"],
            ["qr", "дизайн", "код"],
            ["заказать", "qr", "дизайн"],
            ["qr", "код", "бренд"],
            ["фрилансер", "qr", "дизайн"],
            ["дизайн", "сайта", "ui"],
            ["сайт", "дизайн", "лендинг"],
            ["заказать", "сайт", "дизайн"],
            ["сайт", "веб", "интерфейс"],
            ["фрилансер", "сайт", "дизайн"],
            ["дизайн", "бота", "telegram"],
            ["бот", "дизайн", "интерфейс"],
            ["заказать", "бот", "дизайн"],
            ["бот", "ui", "ux"],
            ["фрилансер", "бот", "дизайн"],
            ["дизайн", "приложения", "мобильное"],
            ["приложение", "дизайн", "интерфейс"],
            ["заказать", "приложение", "дизайн"],
            ["приложение", "ux", "дизайн"],
            ["фрилансер", "приложение", "дизайн"],
            ["дизайн", "визитки", "бренд"],
            ["визитки", "дизайн", "креатив"],
            ["заказать", "визитки", "дизайн"],
            ["визитки", "фирменный", "стиль"],
            ["фрилансер", "визитки", "дизайн"],
            ["дизайн", "плакаты", "реклама"],
            ["плакаты", "дизайн", "яркий"],
            ["заказать", "плакаты", "дизайн"],
            ["плакаты", "креатив", "баннер"],
            ["фрилансер", "плакаты", "дизайн"],
            ["дизайн", "буклеты", "компания"],
            ["буклеты", "дизайн", "информативный"],
            ["заказать", "буклеты", "дизайн"],
            ["буклеты", "фирменный", "стиль"],
            ["фрилансер", "буклеты", "дизайн"],
            ["дизайн", "меню", "ресторан"],
            ["меню", "дизайн", "креатив"],
            ["заказать", "меню", "дизайн"],
            ["меню", "бренд", "стиль"],
            ["фрилансер", "меню", "дизайн"],
            ["дизайн", "каталоги", "продукты"],
            ["каталоги", "дизайн", "визуал"],
            ["заказать", "каталоги", "дизайн"],
            ["каталоги", "фирменный", "стиль"],
            ["фрилансер", "каталоги", "дизайн"],
            ["дизайн", "презентации", "бизнес"],
            ["презентации", "дизайн", "эффектный"],
            ["заказать", "презентации", "дизайн"],
            ["презентации", "визуал", "креатив"],
            ["фрилансер", "презентации", "дизайн"],
            ["дизайн", "инфографики", "данные"],
            ["инфографика", "дизайн", "понятный"],
            ["заказать", "инфографику", "дизайн"],
            ["инфографика", "визуал", "данных"],
            ["фрилансер", "инфографика", "дизайн"],
            ["дизайн", "анимации", "видео"],
            ["анимация", "дизайн", "динамичный"],
            ["заказать", "анимацию", "дизайн"],
            ["анимация", "видео", "креатив"],
            ["фрилансер", "анимация", "дизайн"],
            ["дизайн", "иконки", "приложение"],
            ["иконки", "дизайн", "минималистичный"],
            ["заказать", "иконки", "дизайн"],
            ["иконки", "ui", "ux"],
            ["фрилансер", "иконки", "дизайн"],
            ["дизайн", "шрифты", "бренд"],
            ["шрифты", "дизайн", "уникальный"],
            ["заказать", "шрифты", "дизайн"],
            ["шрифты", "фирменный", "стиль"],
            ["фрилансер", "шрифты", "дизайн"],
            ["дизайн", "цвета", "палитра"],
            ["цвета", "дизайн", "гармоничный"],
            ["заказать", "палитру", "дизайн"],
            ["палитра", "бренд", "цвета"],
            ["фрилансер", "палитра", "дизайн"],
            ["дизайн", "логотипы", "варианты"],
            ["логотипы", "дизайн", "несколько"],
            ["заказать", "логотипы", "дизайн"],
            ["логотипы", "бренд", "варианты"],
            ["фрилансер", "логотипы", "дизайн"],
            ["дизайн", "баннеры", "реклама"],
            ["баннеры", "дизайн", "яркий"],
            ["заказать", "баннеры", "дизайн"],
            ["баннеры", "соцсети", "креатив"],
            ["фрилансер", "баннеры", "дизайн"],
            ["дизайн", "аватарки", "профиль"],
            ["аватарки", "дизайн", "стильный"],
            ["заказать", "аватарки", "дизайн"],
            ["аватарки", "бренд", "яркий"],
            ["фрилансер", "аватарки", "дизайн"],
            ["дизайн", "стикеры", "анимация"],
            ["стикеры", "дизайн", "telegram"],
            ["заказать", "стикеры", "дизайн"],
            ["стикеры", "vk", "креатив"],
            ["фрилансер", "стикеры", "дизайн"],
            ["дизайн", "qr", "код"],
            ["qr", "дизайн", "адаптивный"],
            ["заказать", "qr", "дизайн"],
            ["qr", "код", "бренд"],
            ["фрилансер", "qr", "дизайн"],
            ["дизайн", "сайта", "лендинг"],
            ["сайт", "дизайн", "ui"],
            ["заказать", "сайт", "дизайн"],
            ["сайт", "веб", "интерфейс"],
            ["фрилансер", "сайт", "дизайн"],
            ["дизайн", "бота", "интерфейс"],
            ["бот", "дизайн", "telegram"],
            ["заказать", "бот", "дизайн"],
            ["бот", "ui", "ux"],
            ["фрилансер", "бот", "дизайн"],
            ["дизайн", "приложения", "интерфейс"],
            ["приложение", "дизайн", "мобильное"],
            ["заказать", "приложение", "дизайн"],
            ["приложение", "ux", "дизайн"],
            ["фрилансер", "приложение", "дизайн"],
            ["дизайн", "визитки", "креатив"],
            ["визитки", "дизайн", "бренд"],
            ["заказать", "визитки", "дизайн"],
            ["визитки", "фирменный", "стиль"],
            ["фрилансер", "визитки", "дизайн"],
            ["дизайн", "плакаты", "яркий"],
            ["плакаты", "дизайн", "реклама"],
            ["заказать", "плакаты", "дизайн"],
            ["плакаты", "креатив", "баннер"],
            ["фрилансер", "плакаты", "дизайн"],
            ["дизайн", "буклеты", "информативный"],
            ["буклеты", "дизайн", "компания"],
            ["заказать", "буклеты", "дизайн"],
            ["буклеты", "фирменный", "стиль"],
            ["фрилансер", "буклеты", "дизайн"],
            ["дизайн", "меню", "креатив"],
            ["меню", "дизайн", "ресторан"],
            ["заказать", "меню", "дизайн"],
            ["меню", "бренд", "стиль"],
            ["фрилансер", "меню", "дизайн"],
            ["дизайн", "каталоги", "визуал"],
            ["каталоги", "дизайн", "продукты"],]

    def _init_user(self):
        try:
            user_info = self.vk.users.get()[0]
            self.user_id = user_info['id']
        except Exception as e:
            logger.error(f"Ошибка авторизации: {e}")
            raise

    def _smart_delay(self):
        self.requests_count += 1
        else:
            time.sleep(delay)



        group_info = self._get_group_info(group_id)
        users = []
        offset = 0
        if filters is None:
            filters = {}

        while len(users) < max_users:
            if self.skip_group:
                break
            try:
                self._smart_delay()
                response = self.vk.groups.getMembers(
                    group_id=group_id,
                    offset=offset,
                    count=count,
                    fields='sex,bdate,city,can_write_private_message,last_seen,online'
                )
                items = response.get('items', [])
                if not items:
                    break
                for user in items:
                    if self._filter_user(user, filters):
                        users.append(user)
                        if len(users) >= max_users:
                            break
                offset += count
                if len(items) < count:
                    break
            except Exception as e:
                break
        return users

    def _filter_user(self, user: Dict, filters: Dict) -> bool:
        if 'deactivated' in user:
            return False
        if filters.get('only_can_message', False) and not user.get('can_write_private_message'):
            return False
        if filters.get('only_active', True) and not self._is_user_active(user):
            return False
        if filters.get('city_ids') and user.get('city', {}).get('id') not in filters['city_ids']:
            return False
        if filters.get('sex') and user.get('sex') != filters['sex']:
            return False
        if filters.get('age_from') or filters.get('age_to'):
            age = self._get_user_age(user)
                return False
        return True

    def _is_user_active(self, user: Dict, days: int = 30) -> bool:
        if user.get('online'):
            return True
        if 'last_seen' in user:
        return False

        bdate = user.get('bdate')
        if not bdate or len(bdate.split('.')) != 3:
            return None
        try:
            birth_year = int(bdate.split('.')[2])
        except:
            return None

    def _get_group_info(self, group_id: str) -> Dict:
        try:
        except Exception as e:
            raise

        all_groups = set()
            try:
                groups = response.get('items', [])
                for group in groups:
                            return list(all_groups)
            except Exception as e:

        group_ids = self.find_groups_by_niche(niche, group_count)
        if not group_ids:
            return []

        all_leads = []
                logger.info(f"Парсинг группы: {group_id}...")
                remaining_users = max_users - len(all_leads)
                if remaining_users <= 0:
                    break
                if leads:
                    self.save_users(leads, filename=f"leads_{niche}_{group_id}")
                    all_leads.extend(leads)
                    if len(all_leads) >= max_users:
                        break

        if all_leads:
            unique_leads = self._remove_duplicates(all_leads)
            self.save_users(unique_leads, filename="user_ids")

        logger.info(f"Собрано {len(all_leads)} лидов по нише: {niche}")
        return all_leads


    def save_users(self, users: List[Dict], filename: str = 'user_ids'):
        user_data = []
        for user in users:
            first_name = user.get('first_name', '')
            last_name = user.get('last_name', '')
            user_url = f"https://vk.com/id{user_id}"
        df = pd.DataFrame(user_data, columns=['UserInfo'])
        df = df.drop(columns=['UserInfo'])

        script_dir = os.path.dirname(os.path.abspath(__file__))
        save_path = os.path.join(script_dir, 'vk_spam_bot-main')
        os.makedirs(save_path, exist_ok=True)

        if filename == 'user_ids':
            excel_filename = os.path.join(save_path, "user_ids.xlsx")
            if os.path.exists(excel_filename):
                existing_df = pd.read_excel(excel_filename)
                existing_ids = set(existing_df['ID'].dropna().astype(int).tolist())
                df_filtered = df[~df['ID'].isin(existing_ids)]
                if not df_filtered.empty:
                    combined_df = pd.concat([existing_df, df_filtered], ignore_index=True)
                    combined_df.to_excel(excel_filename, index=False)
            else:
                df.to_excel(excel_filename, index=False)
        else:
            cash_filename = os.path.join(cash_path, f"{filename}.xlsx")
            df.to_excel(cash_filename, index=False)




    def upload_photo(self, peer_id: int, photo_path: str) -> str:
        if not os.path.exists(photo_path):
            return ""
        try:
            upload_url = self.vk.photos.getMessagesUploadServer(peer_id=peer_id)['upload_url']
            response = requests.post(upload_url, files={'photo': open(photo_path, 'rb')}).json()
            if 'error' in response:
                return ""
            photo_data = self.vk.photos.saveMessagesPhoto(**response)
            if not photo_data:
                return ""
            owner_id = photo_data[0]['owner_id']
            photo_id = photo_data[0]['id']
            return f"photo{owner_id}_{photo_id}"
            return ""

                break
                continue
            try:
                attachments = [a for a in attachments if a]
                    self.vk.messages.send(
                        user_id=user_id,
                        message=message,
                        random_id=random.randint(1, 2 ** 31)
                    )
                stats['sent'] += 1
                time.sleep(delay)
            except vk_api.exceptions.ApiError as e:
                stats['failed'] += 1
                    time.sleep(3600)
                    break
                stats['failed'] += 1
        return stats




    else:
    current_niche_index = 0

        logger.info(f"Парсинг по нише: {niche}")

        if leads:
        else:
            logger.warning(f"Не удалось собрать лидов по нише: {niche}")

                photo_paths=[
                    "images/works_design_5.jpg",
                    "images/works_design_8.jpg",
                    "images/works_shop_1.jpg",
                    "images/works_shop_3.jpg",
                    "images/works_shop_4.jpg",
                    "images/works_site_1.jpg",
                    "images/works_site_2.jpg",
                    "images/works_site_5.jpg",





